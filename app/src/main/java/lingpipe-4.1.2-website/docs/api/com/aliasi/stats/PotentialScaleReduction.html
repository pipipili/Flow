<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (1.8.0_45) on Sun Dec 04 16:36:12 EST 2016 -->
<title>PotentialScaleReduction (LingPipe API)</title>
<meta name="date" content="2016-12-04">
<link rel="stylesheet" type="text/css" href="../../../stylesheet.css" title="Style">
<script type="text/javascript" src="../../../script.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="PotentialScaleReduction (LingPipe API)";
        }
    }
    catch(err) {
    }
//-->
var methods = {"i0":10,"i1":10,"i2":10,"i3":10,"i4":10};
var tabs = {65535:["t0","All Methods"],2:["t2","Instance Methods"],8:["t4","Concrete Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../index-all.html">Index</a></li>
<li><a href="../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../com/aliasi/stats/PoissonEstimator.html" title="class in com.aliasi.stats"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../../../com/aliasi/stats/RegressionPrior.html" title="class in com.aliasi.stats"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../index.html?com/aliasi/stats/PotentialScaleReduction.html" target="_top">Frames</a></li>
<li><a href="PotentialScaleReduction.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">com.aliasi.stats</div>
<h2 title="Class PotentialScaleReduction" class="title">Class PotentialScaleReduction</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li><a href="http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">java.lang.Object</a></li>
<li>
<ul class="inheritance">
<li>com.aliasi.stats.PotentialScaleReduction</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<hr>
<br>
<pre>public class <span class="typeNameLabel">PotentialScaleReduction</span>
extends <a href="http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</a></pre>
<div class="block">The <code>PotentialScaleReduction</code> class provides an online
 computationa of Rhat, the potential scale reduction statistic for
 measuring mixing and convergence of multiple Markov chain Monte
 Carlo (MCMC) samplers.

 <p>At construction time, the number of estimators is specified.
 There must be at least two estimators in order to compute Rhat.
 Samples from the Markov chains are provided to this class via the
 <a href="../../../com/aliasi/stats/PotentialScaleReduction.html#update-int-double-"><code>update(int,double)</code></a> method.  

 <h3>Normality Assumptiosn</h3>

 These estimates make nomality assumptions for the samples which are
 not justified at samller sample sizes for all ditribution shapes.
 It may help to transform samples on a [0,1] scale using the inverse
 logistic (logit) transform, and samples representing ratios in
 [0,infinity) using a log transform.
 
 <h3>Definition of Rhat</h3>

 The idea is to compare the cross-chain variances to the within-chain
 variances, with values near 1.0 indicating good mixing, and values
 greater than 1 indicating the potential for better mixing.  

 Suppose we have <code>M</code> Markov chains with <code>N</code> samples
 each, with a sample being a floating point value <code>y[m,n]</code>.
 As usual, <code>y[m,]</code> is the sequence of samples from the single
 chain <code>m</code> and <code>y[,n]</code> are the <code>n</code>-th samples from
 each chain.  Unbiased mean and variance estimates are defined for
 sequences in the usual way (see <a href="../../../com/aliasi/stats/OnlineNormalEstimator.html" title="class in com.aliasi.stats"><code>OnlineNormalEstimator</code></a> for
 definitions).  Using vector notation, <code>mean'(y[,])</code> is the
 average value of all samples whereas <code>mean'(y[m,])</code> is the
 average of samples from chain <code>m</code>; similarly <code>var'(y[,])</code> is the variance over all samples and <code>var'(y[m,])</code> the variance of samples in chain <code>m</code>.

 <p>The definition of the Rhat is:

 <blockquote><pre>
 Rhat = sqrt(varHatPlus/W)</pre></blockquote>

 where <code>varHatPlus</code> is a weighted average of the within-chain
 (<code>W</code>) and between-chain (<code>B</code>) variances.

 <blockquote><pre>
 varHatPlus = (N-1)/N * W + 1/N * B.</pre></blockquote>

 The between-chain variance is defined by

 <blockquote><pre>
 B = N * var'(mean'(y[m,]))

   = N/(M-1) * <big><big>&Sigma;</big></big><sub>m</sub> (mean'(y[m,]) - mean'(y[,]))<sup><sup><big>2</big></sup></sup>.</pre></blockquote>

 The within-chain variance is the average of the unbiased within-chain variance estimates:

 <blockquote><pre>
 W = mean'(var'(y[m,]))

   = 1/M <big><big>&Sigma;</big></big><sub>m</sub> var'(y[m,]).</pre></blockquote>

 This is the usual definition for chains in which there are the same
 number of samples.  For the implementation here, we take <code>N</code>
 to be the minimum of the numbers of samples in the chains.  The
 within-chain statistics <code>mean'(y[m,])</code> and <code>var'(y[m,])</code> are computed using all of the samples for chain <code>m</code>.  But the cross-chain statistics are not normalized, so <code>mean'(y[,])</code> is computed here as <code>mean'(mean'(y[m,]))</code>.

 <h3>Per-Chain and Global Statistics</h3>

 The estimators for the within-chain means and variances, <code>mean'(y[m,])</code>
 and <code>var'(y[m,])</code>, are available through the estimator returned by
 <a href="../../../com/aliasi/stats/PotentialScaleReduction.html#estimator-int-"><code>estimator(int)</code></a>.  

 <p>An estimator for the complete set of samples mean and variance,
 <code>mean'(y[,])</code> and <code>var'(y[,])</code>, are available through
 <a href="../../../com/aliasi/stats/PotentialScaleReduction.html#globalEstimator--"><code>globalEstimator()</code></a>.  Note that these are truly global
 estimates, not the estimates used in asynchronous Rhat calculations
 as defined in he previous section.
 
 <h3>Thread Safety</h3>

 Updates are write operations that need to be read-write
 synchronized with the estimator methods.

 <h3>References</h3>

 The method was introduced by Gelman and Rubin in 1992, summarized in
 their book, and implemented in the R coda package.

 <ul>
 <li> Gelman and Rubin. 1992. <a href="http://www.stat.columbia.edu/~gelman/research/published/itsim.pdf">Inference from iterative simulation using multiple sequences</a> (with discussion).  <i>Statistical Science</i> <b>7</b>.
 <li> Gelman, Carlin, Stern and Rubin. 2004. <i>Bayesian Data Analysis</i>.  Second Edition. Chapman &amp; Hall/CRC.  Section 11.6.
 <li>Plummer, Best, Cowles and Vines. 2009. <a href="http://cran.r-project.org/web/packages/coda/coda.pdf">Coda Package Documentation</a> [pdf]. Version 0.13-4.  On <i>CRAN</i>.
 </ul></div>
<dl>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>Lingpipe3.9.1</dd>
<dt><span class="simpleTagLabel">Version:</span></dt>
<dd>3.9.1</dd>
<dt><span class="simpleTagLabel">Author:</span></dt>
<dd>Bob Carpenter</dd>
</dl>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor.summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Constructor Summary table, listing constructors, and an explanation">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colOne" scope="col">Constructor and Description</th>
</tr>
<tr class="altColor">
<td class="colOne"><code><span class="memberNameLink"><a href="../../../com/aliasi/stats/PotentialScaleReduction.html#PotentialScaleReduction-double:A:A-">PotentialScaleReduction</a></span>(double[][]&nbsp;yss)</code>
<div class="block">Construct a potential scale reduction for the specified matrix
 Of estimates for each chain.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colOne"><code><span class="memberNameLink"><a href="../../../com/aliasi/stats/PotentialScaleReduction.html#PotentialScaleReduction-int-">PotentialScaleReduction</a></span>(int&nbsp;numChains)</code>
<div class="block">Construct a potential scale reduction with the specified number
 of Markov chains for input.</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method.summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span id="t0" class="activeTableTab"><span>All Methods</span><span class="tabEnd">&nbsp;</span></span><span id="t2" class="tableTab"><span><a href="javascript:show(2);">Instance Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t4" class="tableTab"><span><a href="javascript:show(8);">Concrete Methods</a></span><span class="tabEnd">&nbsp;</span></span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr id="i0" class="altColor">
<td class="colFirst"><code><a href="../../../com/aliasi/stats/OnlineNormalEstimator.html" title="class in com.aliasi.stats">OnlineNormalEstimator</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../com/aliasi/stats/PotentialScaleReduction.html#estimator-int-">estimator</a></span>(int&nbsp;chain)</code>
<div class="block">Returns the estimator for the specified chain.</div>
</td>
</tr>
<tr id="i1" class="rowColor">
<td class="colFirst"><code><a href="../../../com/aliasi/stats/OnlineNormalEstimator.html" title="class in com.aliasi.stats">OnlineNormalEstimator</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../com/aliasi/stats/PotentialScaleReduction.html#globalEstimator--">globalEstimator</a></span>()</code>
<div class="block">Returns the estimator that pools the estimates across the
 chains.</div>
</td>
</tr>
<tr id="i2" class="altColor">
<td class="colFirst"><code>int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../com/aliasi/stats/PotentialScaleReduction.html#numChains--">numChains</a></span>()</code>
<div class="block">Returns the number of chains for this estimator.</div>
</td>
</tr>
<tr id="i3" class="rowColor">
<td class="colFirst"><code>double</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../com/aliasi/stats/PotentialScaleReduction.html#rHat--">rHat</a></span>()</code>
<div class="block">Returns the Rhat statistic as defined in the class
 documentation.</div>
</td>
</tr>
<tr id="i4" class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../com/aliasi/stats/PotentialScaleReduction.html#update-int-double-">update</a></span>(int&nbsp;chain,
      double&nbsp;y)</code>
<div class="block">Provide a sample of the specified value from the specified chain.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods.inherited.from.class.java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.<a href="http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</a></h3>
<code><a href="http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Object.html?is-external=true#clone--" title="class or interface in java.lang">clone</a>, <a href="http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Object.html?is-external=true#equals-java.lang.Object-" title="class or interface in java.lang">equals</a>, <a href="http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Object.html?is-external=true#finalize--" title="class or interface in java.lang">finalize</a>, <a href="http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Object.html?is-external=true#getClass--" title="class or interface in java.lang">getClass</a>, <a href="http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Object.html?is-external=true#hashCode--" title="class or interface in java.lang">hashCode</a>, <a href="http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Object.html?is-external=true#notify--" title="class or interface in java.lang">notify</a>, <a href="http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Object.html?is-external=true#notifyAll--" title="class or interface in java.lang">notifyAll</a>, <a href="http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Object.html?is-external=true#toString--" title="class or interface in java.lang">toString</a>, <a href="http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Object.html?is-external=true#wait--" title="class or interface in java.lang">wait</a>, <a href="http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Object.html?is-external=true#wait-long-" title="class or interface in java.lang">wait</a>, <a href="http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Object.html?is-external=true#wait-long-int-" title="class or interface in java.lang">wait</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor.detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a name="PotentialScaleReduction-int-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>PotentialScaleReduction</h4>
<pre>public&nbsp;PotentialScaleReduction(int&nbsp;numChains)</pre>
<div class="block">Construct a potential scale reduction with the specified number
 of Markov chains for input.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>numChains</code> - Number of Markov chains.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="http://java.sun.com/j2se/1.5.0/docs/api/java/lang/IllegalArgumentException.html?is-external=true" title="class or interface in java.lang">IllegalArgumentException</a></code> - If the number of chains is less than 2.</dd>
</dl>
</li>
</ul>
<a name="PotentialScaleReduction-double:A:A-">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>PotentialScaleReduction</h4>
<pre>public&nbsp;PotentialScaleReduction(double[][]&nbsp;yss)</pre>
<div class="block">Construct a potential scale reduction for the specified matrix
 Of estimates for each chain.  The matrix entries <code>yss[m][n]</code> 
 are for the <code>n</code>-th sample from chain <code>m</code>.  The chains
 may have different numbers of samples.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>yss</code> - Matrix of estimates by chain and sample.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="http://java.sun.com/j2se/1.5.0/docs/api/java/lang/IllegalStateException.html?is-external=true" title="class or interface in java.lang">IllegalStateException</a></code> - If the number of chains (length
 of <code>yss</code>) is less than 2.</dd>
</dl>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method.detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="numChains--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>numChains</h4>
<pre>public&nbsp;int&nbsp;numChains()</pre>
<div class="block">Returns the number of chains for this estimator.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>Number of chains for this estimator.</dd>
</dl>
</li>
</ul>
<a name="estimator-int-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>estimator</h4>
<pre>public&nbsp;<a href="../../../com/aliasi/stats/OnlineNormalEstimator.html" title="class in com.aliasi.stats">OnlineNormalEstimator</a>&nbsp;estimator(int&nbsp;chain)</pre>
<div class="block">Returns the estimator for the specified chain.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>chain</code> - Index of chain.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>Estimator for the chain.</dd>
</dl>
</li>
</ul>
<a name="globalEstimator--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>globalEstimator</h4>
<pre>public&nbsp;<a href="../../../com/aliasi/stats/OnlineNormalEstimator.html" title="class in com.aliasi.stats">OnlineNormalEstimator</a>&nbsp;globalEstimator()</pre>
<div class="block">Returns the estimator that pools the estimates across the
 chains.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>Overall estimator for samples.</dd>
</dl>
</li>
</ul>
<a name="update-int-double-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>update</h4>
<pre>public&nbsp;void&nbsp;update(int&nbsp;chain,
                   double&nbsp;y)</pre>
<div class="block">Provide a sample of the specified value from the specified chain.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>chain</code> - Chain from which sample was drawn.</dd>
<dd><code>y</code> - Value of sample.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="http://java.sun.com/j2se/1.5.0/docs/api/java/lang/IndexOutOfBoundsException.html?is-external=true" title="class or interface in java.lang">IndexOutOfBoundsException</a></code> - If the chain is less than zero or
 greater than or equal to the number of chains.</dd>
</dl>
</li>
</ul>
<a name="rHat--">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>rHat</h4>
<pre>public&nbsp;double&nbsp;rHat()</pre>
<div class="block">Returns the Rhat statistic as defined in the class
 documentation.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The Rhat statistic.</dd>
</dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../index-all.html">Index</a></li>
<li><a href="../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../com/aliasi/stats/PoissonEstimator.html" title="class in com.aliasi.stats"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../../../com/aliasi/stats/RegressionPrior.html" title="class in com.aliasi.stats"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../index.html?com/aliasi/stats/PotentialScaleReduction.html" target="_top">Frames</a></li>
<li><a href="PotentialScaleReduction.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</body>
</html>
